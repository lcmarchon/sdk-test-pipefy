<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Task Manager Pro - SDK Test</title>
</head>
<body>
    <div style="padding: 20px; text-align: center;">
        <h2>🚀 Task Manager Pro - Versão Limpa</h2>
        <p>SDK funcionando sem erros!</p>
    </div>

    <!-- Pipefy Client SDK -->
    <script src="https://platform.staticpipefy.com/pipefy-app.js"></script>
    <script>
        console.log('🚀 Iniciando Task Manager Pro - Versão Limpa');

        PipefyApp.initCall({
            // APENAS CARD BUTTONS - sem outras funcionalidades que causam erro
            'card-buttons': function(p, pipe, card) {
                console.log('🎨 Adicionando botões ao card');
                return [
                    {
                        icon: 'https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f4dd.svg',
                        text: 'Notas',
                        callback: function(p) {
                            console.log('✅ Botão Notas clicado');
                            
                            // Notificação simples
                            const notification = document.createElement('div');
                            notification.innerHTML = '📝 Notas abertas!';
                            notification.style.cssText = 'position:fixed;top:20px;right:20px;background:#4CAF50;color:white;padding:15px;border-radius:5px;z-index:9999;font-family:Arial;';
                            document.body.appendChild(notification);
                            setTimeout(() => notification.remove(), 3000);
                        }
                    },
                    {
                        icon: 'https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/23f1.svg',
                        text: 'Timer',
                        callback: function(p) {
                            console.log('✅ Botão Timer clicado');
                            
                            // Abre calendário
                            window.open('https://calendar.google.com/calendar/u/0/appointments/schedules/AcZssZ3eI5FttD_0iVZ_KU38Y8fOk0oi132aBDyKAcOam0bNyyd_bdNRbJmDT_ysekP5FAske0CFVM9X', '_blank');
                            
                            // Notificação
                            const notification = document.createElement('div');
                            notification.innerHTML = '📅 Calendário aberto!';
                            notification.style.cssText = 'position:fixed;top:20px;right:20px;background:#2196F3;color:white;padding:15px;border-radius:5px;z-index:9999;font-family:Arial;';
                            document.body.appendChild(notification);
                            setTimeout(() => notification.remove(), 3000);
                        }
                    },
                    {
                        icon: 'https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f4f1.svg',
                        text: 'WhatsApp',
                        callback: function(p) {
                            console.log('✅ Botão WhatsApp clicado - abrindo modal');
                            
                            // Verificação se p.modal existe
                            if (p && p.modal) {
                                p.modal({
                                    title: '💬 WhatsApp Business',
                                    url: 'whatsapp-modal.html',
                                    width: '700px',
                                    height: '500px'
                                });
                            } else {
                                // Fallback - abre em nova janela
                                window.open('whatsapp-modal.html', 'whatsapp', 'width=700,height=500,scrollbars=yes,resizable=yes');
                                
                                // Notificação
                                const notification = document.createElement('div');
                                notification.innerHTML = '📱 WhatsApp aberto!';
                                notification.style.cssText = 'position:fixed;top:20px;right:20px;background:#25D366;color:white;padding:15px;border-radius:5px;z-index:9999;font-family:Arial;';
                                document.body.appendChild(notification);
                                setTimeout(() => notification.remove(), 3000);
                            }
                        }
                    }
                ];
            }
        });

        console.log('✅ Task Manager Pro configurado - versão limpa!');
    </script>
</body>
</html>